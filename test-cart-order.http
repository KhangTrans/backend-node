### =================================
### CART & ORDER API TESTING
### =================================

@baseUrl = http://localhost:5000
@token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiaWF0IjoxNzY2NzE4Nzc5LCJleHAiOjE3NjczMjM1Nzl9.IiOxlTJlte8cfIbihBvFOr8yNgH0JPFEfdIRqLfPeWU
@adminToken = YOUR_ADMIN_TOKEN_HERE

### =================================
### 1. LOGIN - L·∫•y token
### =================================

### Login User
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "123456"
}

### Login Admin
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "admin@example.com",
  "password": "admin123"
}

### =================================
### 2. GI·ªé H√ÄNG (CART)
### =================================

### Xem gi·ªè h√†ng
GET {{baseUrl}}/api/cart
Authorization: Bearer {{token}}

### Th√™m s·∫£n ph·∫©m v√†o gi·ªè
POST {{baseUrl}}/api/cart
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "productId": 3,
  "quantity": 2
}

### Th√™m s·∫£n ph·∫©m kh√°c v√†o gi·ªè
POST {{baseUrl}}/api/cart
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "productId": 2,
  "quantity": 1
}

### C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong gi·ªè (itemId = 1)
PUT {{baseUrl}}/api/cart/1
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "quantity": 3
}

### X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè (itemId = 1)
DELETE {{baseUrl}}/api/cart/1
Authorization: Bearer {{token}}

### X√≥a to√†n b·ªô gi·ªè h√†ng
DELETE {{baseUrl}}/api/cart
Authorization: Bearer {{token}}

### =================================
### 3. ƒê∆†N H√ÄNG (ORDER) - USER
### =================================

### T·∫°o ƒë∆°n h√†ng t·ª´ gi·ªè h√†ng
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "customerName": "Nguy·ªÖn VƒÉn A",
  "customerEmail": "nguyenvana@example.com",
  "customerPhone": "0901234567",
  "shippingAddress": "123 ƒê∆∞·ªùng L√™ L·ª£i",
  "shippingCity": "TP. H·ªì Ch√≠ Minh",
  "shippingDistrict": "Qu·∫≠n 1",
  "shippingWard": "Ph∆∞·ªùng B·∫øn Ngh√©",
  "shippingNote": "Giao gi·ªù h√†nh ch√≠nh, g·ªçi tr∆∞·ªõc 15 ph√∫t",
  "paymentMethod": "cod"
}

### üî• XEM L·ªäCH S·ª¨ ƒê∆†N H√ÄNG C·ª¶A T√îI (T·∫•t c·∫£ ƒë∆°n)
GET {{baseUrl}}/api/orders/my
Authorization: Bearer {{token}}

### XEM L·ªäCH S·ª¨ ƒê∆†N H√ÄNG - L·ªçc theo tr·∫°ng th√°i pending
GET {{baseUrl}}/api/orders/my?status=pending
Authorization: Bearer {{token}}

### XEM L·ªäCH S·ª¨ ƒê∆†N H√ÄNG - L·ªçc theo tr·∫°ng th√°i delivered
GET {{baseUrl}}/api/orders/my?status=delivered
Authorization: Bearer {{token}}

### XEM L·ªäCH S·ª¨ ƒê∆†N H√ÄNG - Ph√¢n trang
GET {{baseUrl}}/api/orders/my?page=1&limit=5
Authorization: Bearer {{token}}

### üî• XEM CHI TI·∫æT ƒê∆†N H√ÄNG (orderId = 1)
GET {{baseUrl}}/api/orders/1
Authorization: Bearer {{token}}

### XEM CHI TI·∫æT ƒê∆†N H√ÄNG (orderId = 2)
GET {{baseUrl}}/api/orders/2
Authorization: Bearer {{token}}

### H·ªßy ƒë∆°n h√†ng (orderId = 1)
PUT {{baseUrl}}/api/orders/1/cancel
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "reason": "ƒê·ªïi √Ω kh√¥ng mua n·ªØa"
}

### =================================
### 4. QU·∫¢N L√ù ƒê∆†N H√ÄNG (ADMIN)
### =================================

### Xem t·∫•t c·∫£ ƒë∆°n h√†ng (Admin)
GET {{baseUrl}}/api/orders/admin/all
Authorization: Bearer {{adminToken}}

### Xem ƒë∆°n h√†ng theo tr·∫°ng th√°i (Admin)
GET {{baseUrl}}/api/orders/admin/all?status=pending
Authorization: Bearer {{adminToken}}

### T√¨m ki·∫øm ƒë∆°n h√†ng (Admin)
GET {{baseUrl}}/api/orders/admin/all?search=Nguy·ªÖn
Authorization: Bearer {{adminToken}}

### Xem ƒë∆°n h√†ng v·ªõi ph√¢n trang (Admin)
GET {{baseUrl}}/api/orders/admin/all?page=1&limit=10
Authorization: Bearer {{adminToken}}

### C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng (Admin) - X√°c nh·∫≠n ƒë∆°n
PUT {{baseUrl}}/api/orders/admin/1/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "orderStatus": "confirmed"
}

### C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng (Admin) - ƒêang giao
PUT {{baseUrl}}/api/orders/admin/1/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "orderStatus": "shipping"
}

### C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng (Admin) - ƒê√£ giao & ƒê√£ thanh to√°n
PUT {{baseUrl}}/api/orders/admin/1/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "orderStatus": "delivered",
  "paymentStatus": "paid"
}

### Xem th·ªëng k√™ ƒë∆°n h√†ng (Admin)
GET {{baseUrl}}/api/orders/admin/statistics
Authorization: Bearer {{adminToken}}

### =================================
### 5. FLOW ƒê·∫∂T H√ÄNG ƒê·∫¶Y ƒê·ª¶
### =================================

### Step 1: Login
# POST {{baseUrl}}/api/auth/login

### Step 2: Th√™m s·∫£n ph·∫©m v√†o gi·ªè
# POST {{baseUrl}}/api/cart (productId: 1, quantity: 2)

### Step 3: Th√™m th√™m s·∫£n ph·∫©m
# POST {{baseUrl}}/api/cart (productId: 2, quantity: 1)

### Step 4: Xem gi·ªè h√†ng
# GET {{baseUrl}}/api/cart

### Step 5: C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng (n·∫øu c·∫ßn)
# PUT {{baseUrl}}/api/cart/1 (quantity: 3)

### Step 6: T·∫°o ƒë∆°n h√†ng
# POST {{baseUrl}}/api/orders (th√¥ng tin giao h√†ng)

### Step 7: Xem l·ªãch s·ª≠ ƒë∆°n h√†ng
# GET {{baseUrl}}/api/orders/my

### Step 8: Xem chi ti·∫øt ƒë∆°n h√†ng
# GET {{baseUrl}}/api/orders/:orderId

### =================================
### 6. TEST C√ÅC TR∆Ø·ªúNG H·ª¢P ƒê·∫∂C BI·ªÜT
### =================================

### Test: Th√™m s·∫£n ph·∫©m kh√¥ng t·ªìn t·∫°i
POST {{baseUrl}}/api/cart
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "productId": 99999,
  "quantity": 1
}

### Test: Th√™m s·ªë l∆∞·ª£ng v∆∞·ª£t qu√° t·ªìn kho
POST {{baseUrl}}/api/cart
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "productId": 1,
  "quantity": 99999
}

### Test: T·∫°o ƒë∆°n h√†ng khi gi·ªè h√†ng tr·ªëng
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "customerName": "Test User",
  "customerEmail": "test@example.com",
  "customerPhone": "0901234567",
  "shippingAddress": "123 Test St",
  "shippingCity": "HCM",
  "paymentMethod": "cod"
}

### Test: Xem ƒë∆°n h√†ng c·ªßa ng∆∞·ªùi kh√°c (Should fail)
GET {{baseUrl}}/api/orders/999
Authorization: Bearer {{token}}

### Test: H·ªßy ƒë∆°n ƒë√£ giao (Should fail)
PUT {{baseUrl}}/api/orders/1/cancel
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "reason": "Test"
}

### =================================
### 7. PAYMENT METHODS TEST
### =================================

### T·∫°o ƒë∆°n v·ªõi COD
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "customerName": "Test COD",
  "customerEmail": "cod@example.com",
  "customerPhone": "0901111111",
  "shippingAddress": "123 Test",
  "shippingCity": "HCM",
  "paymentMethod": "cod"
}

### T·∫°o ƒë∆°n v·ªõi Chuy·ªÉn kho·∫£n
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "customerName": "Test Bank",
  "customerEmail": "bank@example.com",
  "customerPhone": "0902222222",
  "shippingAddress": "123 Test",
  "shippingCity": "HCM",
  "paymentMethod": "bank_transfer"
}

### T·∫°o ƒë∆°n v·ªõi MoMo
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "customerName": "Test MoMo",
  "customerEmail": "momo@example.com",
  "customerPhone": "0903333333",
  "shippingAddress": "123 Test",
  "shippingCity": "HCM",
  "paymentMethod": "momo"
}

### =================================
### 8. ORDER STATUS FLOW (Admin)
### =================================

### pending ‚Üí processing
PUT {{baseUrl}}/api/orders/admin/1/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "orderStatus": "processing"
}

### processing ‚Üí confirmed
PUT {{baseUrl}}/api/orders/admin/1/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "orderStatus": "confirmed"
}

### confirmed ‚Üí shipping
PUT {{baseUrl}}/api/orders/admin/1/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "orderStatus": "shipping"
}

### shipping ‚Üí delivered
PUT {{baseUrl}}/api/orders/admin/1/status
Authorization: Bearer {{adminToken}}
Content-Type: application/json

{
  "orderStatus": "delivered",
  "paymentStatus": "paid"
}
