### Test Address Management API
### Base URL: http://localhost:5000

### Variables
@baseUrl = http://localhost:5000/api
@token = YOUR_USER_TOKEN_HERE

### ==============================================
### 1. Get All Addresses (Empty at first)
GET {{baseUrl}}/addresses
Authorization: Bearer {{token}}

### ==============================================
### 2. Create First Address (will auto-become default)
POST {{baseUrl}}/addresses
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "fullName": "Nguyễn Văn A",
  "phoneNumber": "0901234567",
  "address": "123 Nguyễn Huệ",
  "city": "TP. Hồ Chí Minh",
  "district": "Quận 1",
  "ward": "Phường Bến Nghé",
  "label": "Nhà riêng"
}

### ==============================================
### 3. Create Second Address (Office)
POST {{baseUrl}}/addresses
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "fullName": "Nguyễn Văn A",
  "phoneNumber": "0901234567",
  "address": "456 Lê Lợi",
  "city": "TP. Hồ Chí Minh",
  "district": "Quận 3",
  "ward": "Phường 5",
  "label": "Văn phòng"
}

### ==============================================
### 4. Create Third Address (Parent's House)
POST {{baseUrl}}/addresses
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "fullName": "Trần Thị B",
  "phoneNumber": "0907654321",
  "address": "789 Điện Biên Phủ",
  "city": "TP. Hồ Chí Minh",
  "district": "Quận 10",
  "ward": "Phường 5",
  "label": "Nhà bố mẹ"
}

### ==============================================
### 5. Get All Addresses (Should see 3 addresses now)
GET {{baseUrl}}/addresses
Authorization: Bearer {{token}}

### ==============================================
### 6. Get Default Address
GET {{baseUrl}}/addresses/default
Authorization: Bearer {{token}}

### ==============================================
### 7. Get Address by ID (Change :addressId to actual ID)
GET {{baseUrl}}/addresses/1
Authorization: Bearer {{token}}

### ==============================================
### 8. Update Address
PUT {{baseUrl}}/addresses/2
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "fullName": "Nguyễn Văn A - Updated",
  "address": "456 Lê Lợi (Updated)",
  "label": "Văn phòng mới"
}

### ==============================================
### 9. Set Address as Default (Address ID 2)
PUT {{baseUrl}}/addresses/2/set-default
Authorization: Bearer {{token}}

### ==============================================
### 10. Get Default Address Again (Should be address ID 2 now)
GET {{baseUrl}}/addresses/default
Authorization: Bearer {{token}}

### ==============================================
### 11. Create Address with Default = true
POST {{baseUrl}}/addresses
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "fullName": "Lê Văn C",
  "phoneNumber": "0912345678",
  "address": "321 Võ Văn Tần",
  "city": "TP. Hồ Chí Minh",
  "district": "Quận 3",
  "ward": "Phường 6",
  "isDefault": true,
  "label": "Nhà mới"
}

### ==============================================
### 12. Get All Addresses (Check order - default first)
GET {{baseUrl}}/addresses
Authorization: Bearer {{token}}

### ==============================================
### 13. Delete Address (Change ID)
DELETE {{baseUrl}}/addresses/3
Authorization: Bearer {{token}}

### ==============================================
### 14. Get All Addresses After Delete
GET {{baseUrl}}/addresses
Authorization: Bearer {{token}}

### ==============================================
### 15. Test Validation - Missing Required Fields
POST {{baseUrl}}/addresses
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "fullName": "Test User"
}

### ==============================================
### 16. Test Get Other User's Address (Should get 403)
### First create another user and get their address ID
### Then try to access with this token
GET {{baseUrl}}/addresses/999
Authorization: Bearer {{token}}

### ==============================================
### 17. Test Update Other User's Address (Should get 403)
PUT {{baseUrl}}/addresses/999
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "fullName": "Hacker"
}

### ==============================================
### 18. Test Delete Other User's Address (Should get 403)
DELETE {{baseUrl}}/addresses/999
Authorization: Bearer {{token}}

### ==============================================
### INTEGRATION TEST - Use address in Order
### ==============================================

### 19. Create Order with Default Address
POST {{baseUrl}}/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "items": [
    {
      "productId": 1,
      "quantity": 1
    }
  ],
  "paymentMethod": "COD",
  "note": "Giao giờ hành chính"
}

### ==============================================
### Test Complete Flow:
### 1. Register/Login → Get token
### 2. Create 3 addresses
### 3. Check default address
### 4. Change default
### 5. Update address
### 6. Delete address
### 7. Check ownership (403 errors)
### 8. Create order with address info
